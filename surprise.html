<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>A Special Surprise</title>
    <meta
      name="description"
      content="A special romantic surprise with heartfelt messages"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Roboto:wght@300;400;500&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        --primary-pink: #e91e63;
        --primary-purple: #9c27b0;
        --accent-gold: #ffd700;
        --dark-bg: #0f0f1a;
        --darker-bg: #0a0a12;
        --card-bg: rgba(25, 25, 40, 0.95);
        --card-border: rgba(255, 255, 255, 0.08);
        --light-text: #f0f0f5;
        --muted-text: #a0a0c0;
        --transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        --shadow-subtle: 0 4px 20px rgba(0, 0, 0, 0.3);
        --shadow-elevated: 0 10px 30px rgba(0, 0, 0, 0.5);
        --glow-pink: 0 0 15px rgba(233, 30, 99, 0.5);
        --glow-purple: 0 0 15px rgba(156, 39, 176, 0.5);
      }

      body {
        font-family: "Roboto", sans-serif;
        background: linear-gradient(
          135deg,
          var(--darker-bg) 0%,
          var(--dark-bg) 100%
        );
        min-height: 100vh;
        color: var(--light-text);
        overflow-x: hidden;
        position: relative;
        line-height: 1.6;
        opacity: 0;
        transition: opacity 0.5s ease;
      }

      h1,
      h2,
      h3 {
        font-family: "Great Vibes", cursive;
        font-weight: 600;
        letter-spacing: 0.5px;
      }

      /* Focus styles for accessibility */
      button:focus-visible,
      a:focus-visible {
        outline: 2px solid var(--accent-gold);
        outline-offset: 2px;
      }

      /* Skip link for accessibility */
      .skip-link {
        position: absolute;
        top: -40px;
        left: 0;
        background: var(--primary-pink);
        color: white;
        padding: 8px;
        z-index: 1000;
        text-decoration: none;
        border-radius: 0 0 4px 0;
        transition: top 0.3s;
      }

      .skip-link:focus {
        top: 0;
      }

      /* Background Animations - Enhanced */
      #hearts-container,
      #petals-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: -1;
      }

      .heart,
      .petal {
        position: absolute;
        opacity: 0;
        filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        will-change: transform;
      }

      .heart {
        font-size: 1.2rem;
        color: var(--primary-pink);
        text-shadow: 0 0 10px rgba(233, 30, 99, 0.7);
        animation: floatHeart 20s infinite linear;
      }

      .petal {
        font-size: 1rem;
        color: var(--primary-purple);
        text-shadow: 0 0 10px rgba(156, 39, 176, 0.7);
        animation: floatPetal 25s infinite linear;
      }

      @keyframes floatHeart {
        0% {
          transform: translateY(100vh) rotate(0deg);
          opacity: 0;
        }
        10% {
          opacity: 0.7;
        }
        90% {
          opacity: 0.7;
        }
        100% {
          transform: translateY(-100vh) rotate(360deg);
          opacity: 0;
        }
      }

      @keyframes floatPetal {
        0% {
          transform: translateY(100vh) rotate(0deg) scale(0.8);
          opacity: 0;
        }
        10% {
          opacity: 0.6;
        }
        90% {
          opacity: 0.6;
        }
        100% {
          transform: translateY(-100vh) rotate(-360deg) scale(1.2);
          opacity: 0;
        }
      }

      /* Music Controls */
      #music-controls {
        position: fixed;
        top: 25px;
        right: 25px;
        z-index: 100;
      }

      #music-toggle {
        background: var(--card-bg);
        border: 1px solid var(--card-border);
        width: 45px;
        height: 45px;
        border-radius: 50%;
        font-size: 1.1rem;
        cursor: pointer;
        backdrop-filter: blur(10px);
        box-shadow: var(--shadow-subtle);
        transition: var(--transition);
        color: var(--primary-purple);
      }

      #music-toggle:hover {
        transform: scale(1.08);
        background: rgba(40, 40, 60, 0.98);
        box-shadow: var(--shadow-elevated);
        color: var(--primary-pink);
      }

      /* Container */
      .container {
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
      }

      .content {
        text-align: center;
        max-width: 800px;
        background: var(--card-bg);
        padding: 50px 40px;
        border-radius: 16px;
        box-shadow: var(--shadow-elevated);
        backdrop-filter: blur(15px);
        border: 1px solid var(--card-border);
        opacity: 0;
        transform: translateY(20px);
        animation: fadeInUp 1s forwards 0.3s;
        position: relative;
        overflow: hidden;
      }

      .content::before {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(
          circle,
          rgba(233, 30, 99, 0.1) 0%,
          transparent 70%
        );
        z-index: -1;
        animation: rotate 20s linear infinite;
      }

      @keyframes rotate {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      @keyframes fadeInUp {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Typography */
      .page-title {
        font-size: 3.5rem;
        margin-bottom: 30px;
        color: var(--primary-purple);
        position: relative;
        display: inline-block;
        text-shadow: var(--glow-purple);
        animation: float 3s ease-in-out infinite;
      }

      @keyframes float {
        0% {
          transform: translateY(0px);
        }
        50% {
          transform: translateY(-10px);
        }
        100% {
          transform: translateY(0px);
        }
      }

      .page-title::after {
        content: "";
        position: absolute;
        bottom: -10px;
        left: 50%;
        transform: translateX(-50%);
        width: 60px;
        height: 2px;
        background: var(--primary-pink);
      }

      .intro-text {
        font-size: 1.15rem;
        line-height: 1.8;
        margin-bottom: 35px;
        color: var(--light-text);
        font-weight: 400;
      }

      /* Buttons */
      .btn {
        display: inline-block;
        padding: 14px 32px;
        font-size: 1.1rem;
        text-decoration: none;
        color: white;
        border-radius: 50px;
        transition: var(--transition);
        margin-top: 20px;
        font-weight: 500;
        letter-spacing: 0.5px;
        border: none;
        cursor: pointer;
        position: relative;
        overflow: hidden;
        font-family: "Roboto", sans-serif;
      }

      .glow-btn {
        background: linear-gradient(
          135deg,
          var(--primary-pink),
          var(--primary-purple)
        );
        box-shadow: 0 4px 15px rgba(156, 39, 176, 0.3);
      }

      .glow-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(156, 39, 176, 0.6), var(--glow-purple);
      }

      .btn::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: left 0.7s;
      }

      .btn:hover::before {
        left: 100%;
      }

      /* Surprise Container */
      .surprise-container {
        margin: 40px 0;
        position: relative;
      }

      #reveal-btn {
        position: relative;
        overflow: hidden;
        z-index: 1;
        font-size: 1.2rem;
        padding: 16px 40px;
      }

      #reveal-btn::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transform: translateX(-100%);
        transition: transform 0.6s;
        z-index: -1;
      }

      #reveal-btn:hover::after {
        transform: translateX(100%);
      }

      /* Love Message */
      #love-message {
        margin-top: 30px;
        padding: 25px;
        background: linear-gradient(
          135deg,
          rgba(233, 30, 99, 0.1),
          rgba(156, 39, 176, 0.1)
        );
        border-radius: 12px;
        display: grid;
        grid-template-columns: 1fr;
        gap: 15px;
        position: relative;
        z-index: 2;
        box-shadow: var(--shadow-subtle);
        border: 1px solid var(--card-border);
        opacity: 0;
        transform: translateY(20px);
        transition: all 0.8s ease;
        display: none;
      }

      #love-message.revealed {
        opacity: 1;
        transform: translateY(0);
        display: grid;
      }

      #love-message p {
        font-size: 1.3rem;
        font-weight: 500;
        color: var(--light-text);
        line-height: 1.6;
        padding: 15px;
        background: rgba(25, 25, 40, 0.7);
        border-radius: 10px;
        border-left: 4px solid #e91e63;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
        animation: fadeInMessage 0.5s ease forwards;
        opacity: 0;
        transform: translateX(-20px);
      }

      #love-message p:nth-child(1) {
        animation-delay: 0.1s;
      }
      #love-message p:nth-child(2) {
        animation-delay: 0.2s;
      }
      #love-message p:nth-child(3) {
        animation-delay: 0.3s;
      }
      #love-message p:nth-child(4) {
        animation-delay: 0.4s;
      }
      #love-message p:nth-child(5) {
        animation-delay: 0.5s;
      }
      #love-message p:nth-child(6) {
        animation-delay: 0.6s;
      }
      #love-message p:nth-child(7) {
        animation-delay: 0.7s;
      }
      #love-message p:nth-child(8) {
        animation-delay: 0.8s;
      }
      #love-message p:nth-child(9) {
        animation-delay: 0.9s;
      }

      @keyframes fadeInMessage {
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      #love-message p::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(233, 30, 99, 0.1),
          transparent
        );
        transition: left 0.7s;
      }

      #love-message p:hover {
        transform: translateX(5px);
        background: rgba(30, 30, 50, 0.8);
      }

      #love-message p:hover::before {
        left: 100%;
      }

      /* Mini Messages */
      .mini-messages {
        display: flex;
        justify-content: center;
        gap: 25px;
        margin-top: 40px;
        flex-wrap: wrap;
      }

      .mini-message {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        background: linear-gradient(
          135deg,
          var(--primary-pink),
          var(--primary-purple)
        );
        display: flex;
        justify-content: center;
        align-items: center;
        color: white;
        font-size: 1.2rem;
        cursor: pointer;
        transition: var(--transition);
        box-shadow: var(--shadow-subtle);
        font-weight: 500;
        position: relative;
        overflow: hidden;
      }

      .mini-message::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        opacity: 0;
        transition: opacity 0.3s;
      }

      .mini-message:hover {
        transform: scale(1.1) rotate(5deg);
        box-shadow: 0 10px 25px rgba(156, 39, 176, 0.5);
      }

      .mini-message:hover::before {
        opacity: 1;
      }

      .mini-message.revealed {
        width: 160px;
        height: auto;
        min-height: 80px;
        border-radius: 20px;
        font-size: 0.9rem;
        padding: 15px;
        text-align: center;
        background: rgba(25, 25, 40, 0.9);
        color: var(--light-text);
        border: 2px solid var(--primary-pink);
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0% {
          box-shadow: 0 0 0 0 rgba(233, 30, 99, 0.4);
        }
        70% {
          box-shadow: 0 0 0 10px rgba(233, 30, 99, 0);
        }
        100% {
          box-shadow: 0 0 0 0 rgba(233, 30, 99, 0);
        }
      }

      /* Confetti Canvas */
      #confetti-canvas {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 9999;
        display: none;
      }

      /* Loading indicator */
      .loading-indicator {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 1000;
        background: var(--card-bg);
        padding: 20px;
        border-radius: 10px;
        box-shadow: var(--shadow-elevated);
        display: none;
      }

      /* Enhanced floating particles */
      .floating-particle {
        position: fixed;
        pointer-events: none;
        z-index: -1;
        opacity: 0;
        animation: floatParticle 15s infinite linear;
      }

      @keyframes floatParticle {
        0% {
          transform: translateY(100vh) rotate(0deg);
          opacity: 0;
        }
        10% {
          opacity: 0.7;
        }
        90% {
          opacity: 0.7;
        }
        100% {
          transform: translateY(-100vh) rotate(360deg);
          opacity: 0;
        }
      }

      /* Enhanced responsive design */
      @media (max-width: 768px) {
        .page-title {
          font-size: 2.8rem;
        }

        .content {
          padding: 30px 25px;
        }

        #love-message p {
          font-size: 1.1rem;
          padding: 12px;
        }

        .mini-message {
          width: 70px;
          height: 70px;
          font-size: 1.1rem;
        }

        .mini-message.revealed {
          width: 140px;
          font-size: 0.85rem;
        }

        .mini-messages {
          gap: 15px;
        }
      }

      @media (max-width: 480px) {
        .page-title {
          font-size: 2.2rem;
        }

        .intro-text {
          font-size: 1.05rem;
        }

        .btn {
          padding: 12px 25px;
          font-size: 1rem;
        }

        #love-message p {
          font-size: 1rem;
        }

        .mini-message {
          width: 60px;
          height: 60px;
          font-size: 1rem;
        }

        .mini-message.revealed {
          width: 120px;
          font-size: 0.8rem;
          padding: 12px;
        }
      }

      /* Reduced motion support */
      @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }

        .heart,
        .petal,
        .floating-particle {
          animation: none;
          opacity: 0.3;
        }
      }

      /* Enhanced visual effects */
      .sparkle {
        position: absolute;
        width: 4px;
        height: 4px;
        background: white;
        border-radius: 50%;
        pointer-events: none;
        z-index: 100;
        animation: sparkle 1.5s ease-out forwards;
      }

      @keyframes sparkle {
        0% {
          transform: scale(0);
          opacity: 0;
        }
        50% {
          transform: scale(1);
          opacity: 1;
        }
        100% {
          transform: scale(0);
          opacity: 0;
        }
      }
    </style>
  </head>
  <body>
    <!-- Skip link for accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Loading indicator -->
    <div class="loading-indicator" id="loading-indicator">
      Loading your special surprise...
    </div>

    <!-- Background animations -->
    <div id="hearts-container"></div>
    <div id="petals-container"></div>

    <!-- Music controls -->
    <div id="music-controls">
      <button id="music-toggle" aria-label="Toggle background music">♪</button>
      <audio id="background-music" loop>
        <source
          src="https://assets.mixkit.co/music/preview/mixkit-romantic-serenade-309.mp3"
          type="audio/mpeg"
        />
        Your browser does not support the audio element.
      </audio>
    </div>

    <!-- Confetti canvas -->
    <canvas id="confetti-canvas"></canvas>

    <!-- Main content -->
    <div class="container" id="main-content" tabindex="-1">
      <div class="content">
        <h1 class="page-title">Just For You 💖</h1>
        <p class="intro-text">
          Click the button below to reveal a special message
        </p>

        <div class="surprise-container">
          <button id="reveal-btn" class="btn glow-btn">
            Reveal My Love 💕
          </button>

          <div id="love-message" aria-live="polite">
            <p>Ap meri zindagi ka sabse beautiful part ho 💕</p>
            <p>Har pal aapke bina adhoora lagta hai 😘</p>
            <p>Apke bina jeena mumkin nahi hai ❤️</p>
            <p>Meri har saans aapke naam hai 💖</p>
            <p>Ap meri muskaan ki wajah ho 🌸</p>
            <p>Meri duaon ka har lafz sirf aapke liye hai 🤲❤️</p>
            <p>Apke saath har lamha ek khubsurat yaad ban jaata hai ✨</p>
            <p>Ap meri duniya ka sabse pyaara ehsaas ho 💞</p>
            <p>Apke bina meri kahani adhuri hai 📖💔</p>
          </div>

          <div class="mini-messages">
            <div
              class="mini-message"
              data-text="Apke muskurane se mera din ban jata hai 😊"
              role="button"
              tabindex="0"
            >
              ?
            </div>
            <div
              class="mini-message"
              data-text="Ap mere sapno ka sach hai 💭"
              role="button"
              tabindex="0"
            >
              ?
            </div>
            <div
              class="mini-message"
              data-text="Apke saath har pal special hai ✨"
              role="button"
              tabindex="0"
            >
              ?
            </div>
          </div>
        </div>

        <a href="index.html" class="btn glow-btn">Back to Start</a>
      </div>
    </div>

    <script>
      // Enhanced Surprise Page with better performance and accessibility
      document.addEventListener("DOMContentLoaded", function () {
        // Show loading indicator initially
        const loadingIndicator = document.getElementById("loading-indicator");
        loadingIndicator.style.display = "block";

        // Fade in the page after a short delay
        setTimeout(() => {
          document.body.style.opacity = "1";
          loadingIndicator.style.display = "none";
        }, 500);

        // DOM Elements
        const musicToggle = document.getElementById("music-toggle");
        const backgroundMusic = document.getElementById("background-music");
        const heartsContainer = document.getElementById("hearts-container");
        const petalsContainer = document.getElementById("petals-container");
        const revealBtn = document.getElementById("reveal-btn");
        const loveMessage = document.getElementById("love-message");
        const miniMessages = document.querySelectorAll(".mini-message");
        const confettiCanvas = document.getElementById("confetti-canvas");

        // Create background animations with optimized performance
        createBackgroundAnimations();

        // Setup music toggle with error handling
        setupMusicToggle();

        // Setup surprise page interactions
        setupSurprisePage();

        // Background Animations - Enhanced
        function createBackgroundAnimations() {
          // Create fewer elements for better performance
          const heartCount = window.innerWidth < 768 ? 8 : 12;
          const petalCount = window.innerWidth < 768 ? 12 : 18;

          // Create floating hearts
          for (let i = 0; i < heartCount; i++) {
            createFloatingElement("💖", heartsContainer, "heart");
          }

          // Create falling petals
          for (let i = 0; i < petalCount; i++) {
            createFloatingElement("🌹", petalsContainer, "petal");
          }

          // Create additional floating particles for enhanced effect
          createFloatingParticles();
        }

        function createFloatingElement(emoji, container, className) {
          const element = document.createElement("div");
          element.className = className;
          element.textContent = emoji;
          element.setAttribute("aria-hidden", "true"); // Hide from screen readers

          // Random position
          const left = Math.random() * 100;
          element.style.left = `${left}%`;

          // Random size
          const size = 0.5 + Math.random() * 1.5;
          element.style.fontSize = `${size}rem`;

          // Random animation duration and delay
          const duration = 15 + Math.random() * 20;
          const delay = Math.random() * 5;
          element.style.animationDuration = `${duration}s`;
          element.style.animationDelay = `${delay}s`;

          container.appendChild(element);
        }

        // Create additional floating particles for enhanced visual effect
        function createFloatingParticles() {
          const particleCount = window.innerWidth < 768 ? 15 : 25;
          const particles = ["✦", "✧", "❀", "✿", "❁", "✽", "✾", "❃"];

          for (let i = 0; i < particleCount; i++) {
            const particle = document.createElement("div");
            particle.className = "floating-particle";
            particle.textContent =
              particles[Math.floor(Math.random() * particles.length)];
            particle.style.color = Math.random() > 0.5 ? "#ff9ec6" : "#c084fc";
            particle.style.fontSize = `${0.5 + Math.random() * 1}rem`;
            particle.style.left = `${Math.random() * 100}%`;
            particle.style.animationDuration = `${20 + Math.random() * 30}s`;
            particle.style.animationDelay = `${Math.random() * 10}s`;
            particle.setAttribute("aria-hidden", "true");

            document.body.appendChild(particle);
          }
        }

        // Music Toggle with error handling
        function setupMusicToggle() {
          if (!musicToggle || !backgroundMusic) return;

          // Check if audio can be played
          backgroundMusic.addEventListener("error", function () {
            console.error("Audio loading failed");
            musicToggle.disabled = true;
            musicToggle.title = "Audio not available";
          });

          musicToggle.addEventListener("click", () => {
            if (backgroundMusic.paused) {
              // Play with error handling
              const playPromise = backgroundMusic.play();
              if (playPromise !== undefined) {
                playPromise.catch((error) => {
                  console.error("Audio play failed:", error);
                  musicToggle.disabled = true;
                  musicToggle.title = "Audio playback failed";
                });
              }
              musicToggle.textContent = "♫";
              musicToggle.setAttribute("aria-label", "Pause background music");
            } else {
              backgroundMusic.pause();
              musicToggle.textContent = "♪";
              musicToggle.setAttribute("aria-label", "Play background music");
            }
          });

          // Set initial aria-label
          musicToggle.setAttribute("aria-label", "Play background music");
        }

        // Surprise Page Setup with better accessibility
        function setupSurprisePage() {
          if (revealBtn && loveMessage) {
            revealBtn.addEventListener("click", revealLoveMessage);
            // Also allow Enter key to trigger the button
            revealBtn.addEventListener("keypress", function (e) {
              if (e.key === "Enter") {
                revealLoveMessage();
              }
            });
          }

          if (miniMessages.length > 0) {
            miniMessages.forEach((message) => {
              message.addEventListener("click", () =>
                revealMiniMessage(message)
              );
              // Also allow keyboard activation
              message.addEventListener("keypress", function (e) {
                if (e.key === "Enter" || e.key === " ") {
                  e.preventDefault();
                  revealMiniMessage(message);
                }
              });
            });
          }
        }

        // Separate function for revealing love message
        function revealLoveMessage() {
          // Create sparkle effect on button
          createSparkleEffect(revealBtn);

          // Hide the button with animation
          revealBtn.style.transform = "scale(0)";
          revealBtn.style.opacity = "0";

          setTimeout(() => {
            revealBtn.style.display = "none";

            // Show the love message with animation
            setTimeout(() => {
              loveMessage.classList.add("revealed");
              // Announce to screen readers
              announceToScreenReader("Love message revealed");
            }, 100);

            // Create confetti effect
            createConfetti();
          }, 500);
        }

        // Separate function for revealing mini messages
        function revealMiniMessage(message) {
          if (!message.classList.contains("revealed")) {
            const text = message.getAttribute("data-text");
            message.textContent = text;
            message.classList.add("revealed");

            // Update accessibility attributes
            message.setAttribute("aria-label", text);

            // Add a small heart animation
            createHeartAnimation(message);

            // Create sparkle effect
            createSparkleEffect(message);

            // Announce to screen readers
            announceToScreenReader("Mini message: " + text);
          }
        }

        // Create sparkle effect
        function createSparkleEffect(element) {
          const rect = element.getBoundingClientRect();
          const sparkleCount = 8;

          for (let i = 0; i < sparkleCount; i++) {
            const sparkle = document.createElement("div");
            sparkle.className = "sparkle";

            // Position sparkles around the element
            const angle = (i / sparkleCount) * Math.PI * 2;
            const distance = 40;
            const x = Math.cos(angle) * distance;
            const y = Math.sin(angle) * distance;

            sparkle.style.left = rect.left + rect.width / 2 + x + "px";
            sparkle.style.top = rect.top + rect.height / 2 + y + "px";

            document.body.appendChild(sparkle);

            // Remove sparkle after animation
            setTimeout(() => {
              if (sparkle.parentNode) {
                sparkle.parentNode.removeChild(sparkle);
              }
            }, 1500);
          }
        }

        // Utility function to announce changes to screen readers
        function announceToScreenReader(message) {
          const announcement = document.createElement("div");
          announcement.setAttribute("aria-live", "polite");
          announcement.setAttribute("aria-atomic", "true");
          announcement.classList.add("sr-only");
          announcement.textContent = message;

          document.body.appendChild(announcement);

          // Remove after a short delay
          setTimeout(() => {
            document.body.removeChild(announcement);
          }, 1000);
        }

        // CSS for screen reader only content
        const srOnlyCSS = `
          .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
          }
        `;

        // Add the CSS to the document
        const style = document.createElement("style");
        style.textContent = srOnlyCSS;
        document.head.appendChild(style);

        // Confetti Effect with performance optimization
        function createConfetti() {
          if (!confettiCanvas) return;

          const ctx = confettiCanvas.getContext("2d");
          confettiCanvas.width = window.innerWidth;
          confettiCanvas.height = window.innerHeight;

          // Reduce confetti count for better performance
          const confettiCount = window.innerWidth < 768 ? 80 : 120;
          const confettiPieces = [];
          const colors = [
            "#ff9ec6",
            "#c084fc",
            "#fda4af",
            "#f9a8d4",
            "#e9d5ff",
          ];

          class ConfettiPiece {
            constructor() {
              this.x = Math.random() * confettiCanvas.width;
              this.y = -20;
              this.size = Math.random() * 8 + 4; // Slightly smaller for performance
              this.speed = Math.random() * 3 + 2;
              this.angle = Math.random() * Math.PI * 2;
              this.rotation = Math.random() * 360;
              this.rotationSpeed = Math.random() * 5 - 2.5;
              this.color = colors[Math.floor(Math.random() * colors.length)];
              this.shape = Math.random() > 0.5 ? "circle" : "rect";
            }

            update() {
              this.y += this.speed;
              this.x += Math.sin(this.angle) * 0.5;
              this.angle += 0.02;
              this.rotation += this.rotationSpeed;
            }

            draw() {
              ctx.save();
              ctx.translate(this.x, this.y);
              ctx.rotate((this.rotation * Math.PI) / 180);

              if (this.shape === "circle") {
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(0, 0, this.size, 0, Math.PI * 2);
                ctx.fill();
              } else {
                ctx.fillStyle = this.color;
                ctx.fillRect(
                  -this.size / 2,
                  -this.size / 2,
                  this.size,
                  this.size
                );
              }

              ctx.restore();
            }
          }

          // Create confetti pieces
          for (let i = 0; i < confettiCount; i++) {
            confettiPieces.push(new ConfettiPiece());
          }

          let animationId;

          // Animation loop with performance optimization
          function animate() {
            ctx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);

            let allDone = true;
            confettiPieces.forEach((piece) => {
              if (piece.y < confettiCanvas.height + 50) {
                piece.update();
                piece.draw();
                allDone = false;
              }
            });

            if (!allDone) {
              animationId = requestAnimationFrame(animate);
            } else {
              cancelAnimationFrame(animationId);
              confettiCanvas.style.display = "none";
            }
          }

          confettiCanvas.style.display = "block";
          animationId = requestAnimationFrame(animate);
        }

        // Create heart animation for mini messages
        function createHeartAnimation(element) {
          const rect = element.getBoundingClientRect();
          const heart = document.createElement("div");
          heart.innerHTML = "💖";
          heart.style.position = "fixed";
          heart.style.left = rect.left + rect.width / 2 + "px";
          heart.style.top = rect.top + "px";
          heart.style.fontSize = "1.5rem";
          heart.style.zIndex = "9999";
          heart.style.pointerEvents = "none";
          heart.style.animation = "heartFloat 2s ease-out forwards";

          // Add animation keyframes
          const style = document.createElement("style");
          style.textContent = `
            @keyframes heartFloat {
              0% {
                transform: translateY(0) scale(1);
                opacity: 1;
              }
              100% {
                transform: translateY(-100px) scale(0.5);
                opacity: 0;
              }
            }
          `;
          document.head.appendChild(style);

          document.body.appendChild(heart);

          // Remove after animation completes
          setTimeout(() => {
            document.body.removeChild(heart);
          }, 2000);
        }

        // Handle window resize for responsive adjustments
        window.addEventListener("resize", function () {
          // Update confetti canvas size
          if (confettiCanvas) {
            confettiCanvas.width = window.innerWidth;
            confettiCanvas.height = window.innerHeight;
          }
        });

        // Add a subtle parallax effect to background elements
        document.addEventListener("mousemove", function (e) {
          const hearts = document.querySelectorAll(".heart");
          const petals = document.querySelectorAll(".petal");

          // Apply subtle parallax effect
          hearts.forEach((heart) => {
            const speed = 0.5;
            const x = (e.clientX * speed) / 100;
            const y = (e.clientY * speed) / 100;
            heart.style.transform = `translate(${x}px, ${y}px)`;
          });

          petals.forEach((petal) => {
            const speed = 0.3;
            const x = (e.clientX * speed) / 100;
            const y = (e.clientY * speed) / 100;
            petal.style.transform = `translate(${x}px, ${y}px)`;
          });
        });
      });
    </script>
  </body>
</html>
