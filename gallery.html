<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Our Memories Gallery</title>
    <link rel="stylesheet" href="style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Roboto:wght@300;400;500&display=swap"
      rel="stylesheet"
    />
    <style>
      /* Enhanced Gallery Styles */
      .gallery-controls {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin: 25px 0;
        flex-wrap: wrap;
      }

      .gallery-filter {
        padding: 8px 16px;
        background: rgba(25, 25, 40, 0.8);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 20px;
        color: var(--light-text);
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 0.9rem;
      }

      .gallery-filter.active {
        background: linear-gradient(
          135deg,
          var(--primary-pink),
          var(--primary-purple)
        );
        box-shadow: 0 0 10px rgba(233, 30, 99, 0.5);
      }

      .gallery-stats {
        text-align: center;
        margin: 20px 0;
        font-size: 1.1rem;
        color: var(--muted-text);
      }

      .gallery-zoom {
        position: absolute;
        top: 15px;
        right: 15px;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        cursor: pointer;
        opacity: 0;
        transition: all 0.3s ease;
        z-index: 2;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
      }

      .gallery-item:hover .gallery-zoom {
        opacity: 1;
      }

      .gallery-favorite {
        position: absolute;
        top: 15px;
        left: 15px;
        background: rgba(0, 0, 0, 0.7);
        color: gold;
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        cursor: pointer;
        opacity: 0;
        transition: all 0.3s ease;
        z-index: 2;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
      }

      .gallery-item:hover .gallery-favorite {
        opacity: 1;
      }

      .gallery-favorite.active {
        opacity: 1;
        color: #ffd700;
        text-shadow: 0 0 10px gold;
      }

      .gallery-download {
        position: absolute;
        bottom: 15px;
        right: 15px;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        cursor: pointer;
        opacity: 0;
        transition: all 0.3s ease;
        z-index: 2;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.1rem;
      }

      .gallery-item:hover .gallery-download {
        opacity: 1;
      }

      /* Modal Enhancements */
      .modal-controls {
        position: absolute;
        top: 20px;
        left: 20px;
        display: flex;
        gap: 10px;
        z-index: 1002;
      }

      .modal-btn {
        background: rgba(0, 0, 0, 0.7);
        color: white;
        border: none;
        border-radius: 50%;
        width: 45px;
        height: 45px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.3rem;
        transition: all 0.3s ease;
      }

      .modal-btn:hover {
        background: rgba(233, 30, 99, 0.8);
        transform: scale(1.1);
      }

      .modal-nav {
        position: absolute;
        top: 50%;
        width: 100%;
        display: flex;
        justify-content: space-between;
        padding: 0 20px;
        z-index: 1002;
        transform: translateY(-50%);
      }

      .nav-btn {
        background: rgba(0, 0, 0, 0.7);
        color: white;
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        transition: all 0.3s ease;
      }

      .nav-btn:hover {
        background: rgba(233, 30, 99, 0.8);
        transform: scale(1.1);
      }

      .modal-counter {
        position: absolute;
        top: 20px;
        right: 20px;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 8px 15px;
        border-radius: 20px;
        font-size: 0.9rem;
        z-index: 1002;
      }

      /* Slideshow Controls */
      .slideshow-controls {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin: 20px 0;
      }

      .slideshow-btn {
        padding: 10px 20px;
        background: rgba(25, 25, 40, 0.8);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 25px;
        color: var(--light-text);
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 0.9rem;
      }

      .slideshow-btn.active {
        background: linear-gradient(
          135deg,
          var(--primary-pink),
          var(--primary-purple)
        );
      }

      /* Animation for new features */
      @keyframes featurePulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
        100% {
          transform: scale(1);
        }
      }

      .feature-highlight {
        animation: featurePulse 2s infinite;
      }

      /* Responsive adjustments */
      @media (max-width: 768px) {
        .gallery-controls {
          gap: 10px;
        }

        .gallery-filter {
          padding: 6px 12px;
          font-size: 0.8rem;
        }

        .modal-controls {
          top: 10px;
          left: 10px;
        }

        .modal-btn {
          width: 35px;
          height: 35px;
          font-size: 1rem;
        }

        .nav-btn {
          width: 40px;
          height: 40px;
          font-size: 1.2rem;
        }

        .modal-counter {
          top: 10px;
          right: 10px;
          font-size: 0.8rem;
        }
      }
    </style>
  </head>
  <body>
    <!-- Background animations -->
    <div id="hearts-container"></div>
    <div id="petals-container"></div>

    <!-- Music controls -->
    <div id="music-controls">
      <button id="music-toggle">‚ô™</button>
      <audio id="background-music" loop>
        <source src="assets/music/romantic.mp3" type="audio/mpeg" />
      </audio>
    </div>

    <!-- Main content -->
    <div class="container">
      <div class="content fade-in">
        <h1 class="page-title">Our Memories Gallery</h1>

        <!-- Gallery Controls -->
        <div class="gallery-controls">
          <div class="gallery-filter active" data-filter="all">
            All Memories
          </div>
          <div class="gallery-filter" data-filter="favorites">Favorites ‚≠ê</div>
          <div class="slideshow-controls"></div>
        </div>

        <div class="gallery-stats">
          <span id="photo-count">6</span> Precious Moments ‚Ä¢
          <span id="favorite-count">0</span> Favorites
        </div>

        <div class="gallery-grid">
          <div class="gallery-item" data-index="0" data-favorite="false">
            <button class="gallery-favorite" title="Add to favorites">‚òÜ</button>
            <button class="gallery-zoom" title="Zoom image">üîç</button>
            <button class="gallery-download" title="Download image">‚§ì</button>
            <img src="assets/me1.jpeg" alt="Memory 1" />
          </div>
          <div class="gallery-item" data-index="1" data-favorite="false">
            <button class="gallery-favorite" title="Add to favorites">‚òÜ</button>
            <button class="gallery-zoom" title="Zoom image">üîç</button>
            <button class="gallery-download" title="Download image">‚§ì</button>
            <img src="assets/me2.jpeg" alt="Memory 2" />
          </div>
          <div class="gallery-item" data-index="2" data-favorite="false">
            <button class="gallery-favorite" title="Add to favorites">‚òÜ</button>
            <button class="gallery-zoom" title="Zoom image">üîç</button>
            <button class="gallery-download" title="Download image">‚§ì</button>
            <img src="assets/me3.jpeg" alt="Memory 3" />
          </div>
          <div class="gallery-item" data-index="3" data-favorite="false">
            <button class="gallery-favorite" title="Add to favorites">‚òÜ</button>
            <button class="gallery-zoom" title="Zoom image">üîç</button>
            <button class="gallery-download" title="Download image">‚§ì</button>
            <img src="assets/me4.jpeg" alt="Memory 4" />
          </div>
          <div class="gallery-item" data-index="4" data-favorite="false">
            <button class="gallery-favorite" title="Add to favorites">‚òÜ</button>
            <button class="gallery-zoom" title="Zoom image">üîç</button>
            <button class="gallery-download" title="Download image">‚§ì</button>
            <img src="assets/me5.jpeg" alt="Memory 5" />
          </div>
          <div class="gallery-item" data-index="5" data-favorite="false">
            <button class="gallery-favorite" title="Add to favorites">‚òÜ</button>
            <button class="gallery-zoom" title="Zoom image">üîç</button>
            <button class="gallery-download" title="Download image">‚§ì</button>
            <img src="assets/me6.jpeg" alt="Memory 6" />
          </div>
        </div>

        <a href="surprise.html" class="btn glow-btn">A Little Surprise üéÅ</a>
      </div>
    </div>

    <!-- Enhanced Modal -->
    <div id="image-modal" class="modal">
      <span class="close">&times;</span>
      <div class="modal-controls">
        <button class="modal-btn" id="modal-favorite" title="Toggle favorite">
          ‚òÜ
        </button>
        <button class="modal-btn" id="modal-download" title="Download image">
          ‚§ì
        </button>
      </div>
      <div class="modal-nav">
        <button class="nav-btn" id="prev-btn">‚Äπ</button>
        <button class="nav-btn" id="next-btn">‚Ä∫</button>
      </div>
      <div class="modal-counter">
        <span id="current-index">1</span> / <span id="total-images">6</span>
      </div>
      <div class="modal-content">
        <img id="modal-img" src="" alt="Enlarged memory" />
      </div>
    </div>

    <script>
      // Enhanced Gallery Functionality
      document.addEventListener("DOMContentLoaded", function () {
        const galleryItems = document.querySelectorAll(".gallery-item");
        const modal = document.getElementById("image-modal");
        const modalImg = document.getElementById("modal-img");
        const closeBtn = document.querySelector(".close");
        const favoriteBtns = document.querySelectorAll(".gallery-favorite");
        const downloadBtns = document.querySelectorAll(".gallery-download");
        const zoomBtns = document.querySelectorAll(".gallery-zoom");
        const filters = document.querySelectorAll(".gallery-filter");
        const slideshowBtns = document.querySelectorAll(".slideshow-btn");
        const modalFavorite = document.getElementById("modal-favorite");
        const modalDownload = document.getElementById("modal-download");
        const prevBtn = document.getElementById("prev-btn");
        const nextBtn = document.getElementById("next-btn");
        const currentIndexSpan = document.getElementById("current-index");
        const totalImagesSpan = document.getElementById("total-images");
        const photoCountSpan = document.getElementById("photo-count");
        const favoriteCountSpan = document.getElementById("favorite-count");

        let currentImageIndex = 0;
        let autoSlideInterval;
        let slideSpeed = 2000; // Default speed

        // Initialize counts
        photoCountSpan.textContent = galleryItems.length;
        updateFavoriteCount();

        // Enhanced modal opening with controls
        function openModal(index) {
          currentImageIndex = index;
          const img = galleryItems[index].querySelector("img");
          modalImg.src = img.src;
          modal.style.display = "block";
          updateModalControls();
          startAutoSlide();
        }

        function updateModalControls() {
          currentIndexSpan.textContent = currentImageIndex + 1;
          totalImagesSpan.textContent = galleryItems.length;

          // Update favorite button state
          const isFavorite =
            galleryItems[currentImageIndex].dataset.favorite === "true";
          modalFavorite.textContent = isFavorite ? "‚òÖ" : "‚òÜ";
          modalFavorite.style.color = isFavorite ? "gold" : "white";
        }

        // Enhanced auto-slide functionality
        function startAutoSlide() {
          clearInterval(autoSlideInterval);
          autoSlideInterval = setInterval(() => {
            nextImage();
          }, slideSpeed);
        }

        function nextImage() {
          currentImageIndex = (currentImageIndex + 1) % galleryItems.length;
          const img = galleryItems[currentImageIndex].querySelector("img");
          modalImg.src = img.src;
          updateModalControls();
        }

        function prevImage() {
          currentImageIndex =
            (currentImageIndex - 1 + galleryItems.length) % galleryItems.length;
          const img = galleryItems[currentImageIndex].querySelector("img");
          modalImg.src = img.src;
          updateModalControls();
        }

        // Favorite functionality
        function toggleFavorite(index) {
          const item = galleryItems[index];
          const isFavorite = item.dataset.favorite === "true";
          item.dataset.favorite = (!isFavorite).toString();

          const favoriteBtn = item.querySelector(".gallery-favorite");
          favoriteBtn.textContent = !isFavorite ? "‚òÖ" : "‚òÜ";
          favoriteBtn.classList.toggle("active", !isFavorite);

          updateFavoriteCount();
          updateModalControls();
        }

        function updateFavoriteCount() {
          const favoriteCount = Array.from(galleryItems).filter(
            (item) => item.dataset.favorite === "true"
          ).length;
          favoriteCountSpan.textContent = favoriteCount;
        }

        // Download functionality
        function downloadImage(index) {
          const img = galleryItems[index].querySelector("img");
          const link = document.createElement("a");
          link.href = img.src;
          link.download = `memory-${index + 1}.jpg`;
          link.click();
        }

        // Filter functionality
        function filterGallery(filterType) {
          galleryItems.forEach((item) => {
            if (filterType === "all") {
              item.style.display = "block";
            } else if (filterType === "favorites") {
              item.style.display =
                item.dataset.favorite === "true" ? "block" : "none";
            }
          });
        }

        // Event listeners
        galleryItems.forEach((item, index) => {
          item.addEventListener("click", (e) => {
            if (
              !e.target.classList.contains("gallery-favorite") &&
              !e.target.classList.contains("gallery-download") &&
              !e.target.classList.contains("gallery-zoom")
            ) {
              openModal(index);
            }
          });
        });

        favoriteBtns.forEach((btn, index) => {
          btn.addEventListener("click", (e) => {
            e.stopPropagation();
            toggleFavorite(index);
            btn.classList.add("feature-highlight");
            setTimeout(() => btn.classList.remove("feature-highlight"), 2000);
          });
        });

        downloadBtns.forEach((btn, index) => {
          btn.addEventListener("click", (e) => {
            e.stopPropagation();
            downloadImage(index);
          });
        });

        zoomBtns.forEach((btn, index) => {
          btn.addEventListener("click", (e) => {
            e.stopPropagation();
            openModal(index);
          });
        });

        filters.forEach((filter) => {
          filter.addEventListener("click", () => {
            filters.forEach((f) => f.classList.remove("active"));
            filter.classList.add("active");
            filterGallery(filter.dataset.filter);
          });
        });

        slideshowBtns.forEach((btn) => {
          btn.addEventListener("click", () => {
            slideshowBtns.forEach((b) => b.classList.remove("active"));
            btn.classList.add("active");
            slideSpeed = parseInt(btn.dataset.speed);
            if (modal.style.display === "block") {
              startAutoSlide();
            }
          });
        });

        modalFavorite.addEventListener("click", () => {
          toggleFavorite(currentImageIndex);
        });

        modalDownload.addEventListener("click", () => {
          downloadImage(currentImageIndex);
        });

        prevBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          prevImage();
          startAutoSlide(); // Restart timer after manual navigation
        });

        nextBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          nextImage();
          startAutoSlide(); // Restart timer after manual navigation
        });

        closeBtn.addEventListener("click", closeModal);

        modal.addEventListener("click", (e) => {
          if (e.target === modal) {
            closeModal();
          }
        });

        function closeModal() {
          modal.style.display = "none";
          clearInterval(autoSlideInterval);
        }

        // Keyboard navigation
        document.addEventListener("keydown", (e) => {
          if (modal.style.display === "block") {
            if (e.key === "Escape") closeModal();
            if (e.key === "ArrowRight") {
              nextImage();
              startAutoSlide();
            }
            if (e.key === "ArrowLeft") {
              prevImage();
              startAutoSlide();
            }
            if (e.key === "f") {
              toggleFavorite(currentImageIndex);
            }
          }
        });

        // Initialize favorites from localStorage
        function initializeFavorites() {
          galleryItems.forEach((item, index) => {
            const savedFavorite = localStorage.getItem(
              `gallery-favorite-${index}`
            );
            if (savedFavorite === "true") {
              item.dataset.favorite = "true";
              const favoriteBtn = item.querySelector(".gallery-favorite");
              favoriteBtn.textContent = "‚òÖ";
              favoriteBtn.classList.add("active");
            }
          });
          updateFavoriteCount();
        }

        // Save favorites to localStorage
        function saveFavoriteToStorage(index, isFavorite) {
          localStorage.setItem(
            `gallery-favorite-${index}`,
            isFavorite.toString()
          );
        }

        // Update toggleFavorite function to save to localStorage
        const originalToggleFavorite = toggleFavorite;
        toggleFavorite = function (index) {
          originalToggleFavorite(index);
          const isFavorite = galleryItems[index].dataset.favorite === "true";
          saveFavoriteToStorage(index, isFavorite);
        };

        initializeFavorites();
      });
    </script>
  </body>
</html>
