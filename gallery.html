<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Our Memories Gallery</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Roboto:wght@300;400;500&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --primary-pink: #e91e63;
        --primary-purple: #9c27b0;
        --primary-blue: #2196f3;
        --card-bg: rgba(255, 255, 255, 0.1);
        --card-border: rgba(255, 255, 255, 0.2);
        --light-text: #ffffff;
        --muted-text: rgba(255, 255, 255, 0.7);
        --shadow-subtle: 0 4px 6px rgba(0, 0, 0, 0.1);
        --shadow-elevated: 0 10px 20px rgba(0, 0, 0, 0.2);
        --transition: all 0.3s ease;
        --gradient-bg: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
        --gradient-primary: linear-gradient(
          45deg,
          var(--primary-pink),
          var(--primary-purple)
        );
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", "Roboto", sans-serif;
      }

      body {
        background: var(--gradient-bg);
        color: white;
        min-height: 100vh;
        overflow-x: hidden;
        position: relative;
      }

      /* Background animations */
      #hearts-container,
      #petals-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: -1;
      }

      .heart,
      .petal {
        position: absolute;
        opacity: 0.7;
      }

      .heart {
        animation: float 8s linear infinite;
      }

      .petal {
        animation: fall 10s linear infinite;
      }

      @keyframes float {
        0% {
          transform: translateY(100vh) rotate(0deg);
          opacity: 1;
        }
        100% {
          transform: translateY(-100px) rotate(360deg);
          opacity: 0;
        }
      }

      @keyframes fall {
        0% {
          transform: translateY(-100px) rotate(0deg);
          opacity: 1;
        }
        100% {
          transform: translateY(100vh) rotate(360deg);
          opacity: 0;
        }
      }

      /* Container */
      .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 20px;
      }

      .content {
        text-align: center;
        padding: 20px;
      }

      .fade-in {
        animation: fadeIn 1s ease-out;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Header */
      .page-title {
        font-size: 3.5rem;
        margin-bottom: 15px;
        text-shadow: 0 0 15px rgba(233, 30, 99, 0.7);
        animation: pulse 2s infinite, glow 3s infinite alternate;
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        display: inline-block;
        font-family: "Great Vibes", cursive;
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
        100% {
          transform: scale(1);
        }
      }

      @keyframes glow {
        0% {
          text-shadow: 0 0 10px rgba(233, 30, 99, 0.5);
        }
        100% {
          text-shadow: 0 0 20px rgba(233, 30, 99, 0.8),
            0 0 30px rgba(156, 39, 176, 0.6);
        }
      }

      /* Enhanced Gallery Controls */
      .gallery-controls {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin: 25px 0;
        flex-wrap: wrap;
        background: rgba(255, 255, 255, 0.05);
        padding: 20px;
        border-radius: 12px;
        box-shadow: var(--shadow-subtle);
      }

      .gallery-filter {
        padding: 10px 20px;
        background: rgba(25, 25, 40, 0.8);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 25px;
        color: var(--light-text);
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 0.95rem;
        font-weight: 500;
      }

      .gallery-filter:hover {
        background: rgba(40, 40, 60, 0.9);
        transform: translateY(-2px);
      }

      .gallery-filter.active {
        background: var(--gradient-primary);
        box-shadow: 0 0 15px rgba(233, 30, 99, 0.5);
      }

      .gallery-stats {
        text-align: center;
        margin: 20px 0;
        font-size: 1.1rem;
        color: var(--muted-text);
        background: rgba(255, 255, 255, 0.05);
        padding: 15px;
        border-radius: 10px;
        display: inline-block;
        min-width: 300px;
      }

      /* Enhanced Gallery Grid */
      .gallery-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 25px;
        margin: 30px 0;
      }

      .gallery-item {
        position: relative;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: var(--shadow-subtle);
        transition: var(--transition);
        cursor: pointer;
        aspect-ratio: 1;
        background: rgba(30, 30, 45, 0.5);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .gallery-item:hover {
        transform: translateY(-10px) scale(1.02);
        box-shadow: var(--shadow-elevated);
        border-color: var(--primary-pink);
      }

      .gallery-item img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: var(--transition);
      }

      .gallery-item:hover img {
        transform: scale(1.05);
      }

      .gallery-item::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          to bottom,
          transparent 50%,
          rgba(0, 0, 0, 0.7)
        );
        opacity: 0;
        transition: var(--transition);
        z-index: 1;
      }

      .gallery-item:hover::before {
        opacity: 1;
      }

      /* Enhanced Gallery Buttons */
      .gallery-zoom,
      .gallery-favorite,
      .gallery-download {
        position: absolute;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        border: none;
        border-radius: 50%;
        width: 45px;
        height: 45px;
        cursor: pointer;
        opacity: 0;
        transition: all 0.3s ease;
        z-index: 2;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
        backdrop-filter: blur(5px);
      }

      .gallery-item:hover .gallery-zoom,
      .gallery-item:hover .gallery-favorite,
      .gallery-item:hover .gallery-download {
        opacity: 1;
        transform: translateY(0);
      }

      .gallery-zoom {
        top: 15px;
        right: 15px;
        transform: translateY(-10px);
      }

      .gallery-favorite {
        top: 15px;
        left: 15px;
        transform: translateY(-10px);
        color: gold;
      }

      .gallery-download {
        bottom: 15px;
        right: 15px;
        transform: translateY(10px);
      }

      .gallery-favorite.active {
        opacity: 1;
        color: #ffd700;
        text-shadow: 0 0 10px gold;
      }

      .gallery-zoom:hover,
      .gallery-favorite:hover,
      .gallery-download:hover {
        background: rgba(233, 30, 99, 0.8);
        transform: scale(1.1);
      }

      /* Slideshow Controls */
      .slideshow-controls {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin: 20px 0;
      }

      .slideshow-btn {
        padding: 10px 20px;
        background: rgba(25, 25, 40, 0.8);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 25px;
        color: var(--light-text);
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 0.9rem;
      }

      .slideshow-btn:hover {
        background: rgba(40, 40, 60, 0.9);
      }

      .slideshow-btn.active {
        background: var(--gradient-primary);
        box-shadow: 0 0 10px rgba(233, 30, 99, 0.5);
      }

      /* Enhanced Modal */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.9);
        z-index: 1000;
        justify-content: center;
        align-items: center;
        backdrop-filter: blur(10px);
      }

      .modal-content {
        position: relative;
        max-width: 90%;
        max-height: 90%;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .modal-content img {
        max-width: 100%;
        max-height: 90vh;
        object-fit: contain;
        border-radius: 10px;
        box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
        animation: zoomIn 0.3s ease-out;
      }

      @keyframes zoomIn {
        from {
          transform: scale(0.8);
          opacity: 0;
        }
        to {
          transform: scale(1);
          opacity: 1;
        }
      }

      .close {
        position: absolute;
        top: 20px;
        right: 30px;
        font-size: 2.5rem;
        cursor: pointer;
        color: white;
        transition: var(--transition);
        z-index: 1002;
        background: rgba(0, 0, 0, 0.5);
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .close:hover {
        color: var(--primary-pink);
        transform: scale(1.1);
        background: rgba(0, 0, 0, 0.7);
      }

      /* Modal Controls */
      .modal-controls {
        position: absolute;
        top: 20px;
        left: 20px;
        display: flex;
        gap: 10px;
        z-index: 1002;
      }

      .modal-btn {
        background: rgba(0, 0, 0, 0.7);
        color: white;
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.3rem;
        transition: all 0.3s ease;
        backdrop-filter: blur(5px);
      }

      .modal-btn:hover {
        background: rgba(233, 30, 99, 0.8);
        transform: scale(1.1);
      }

      .modal-nav {
        position: absolute;
        top: 50%;
        width: 100%;
        display: flex;
        justify-content: space-between;
        padding: 0 20px;
        z-index: 1002;
        transform: translateY(-50%);
      }

      .nav-btn {
        background: rgba(0, 0, 0, 0.7);
        color: white;
        border: none;
        border-radius: 50%;
        width: 60px;
        height: 60px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.8rem;
        transition: all 0.3s ease;
        backdrop-filter: blur(5px);
      }

      .nav-btn:hover {
        background: rgba(233, 30, 99, 0.8);
        transform: scale(1.1);
      }

      .modal-counter {
        position: absolute;
        top: 20px;
        right: 20px;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 10px 20px;
        border-radius: 25px;
        font-size: 1rem;
        z-index: 1002;
        backdrop-filter: blur(5px);
      }

      /* Music Controls */
      #music-controls {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 100;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      #music-toggle {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: var(--card-bg);
        border: 1px solid var(--card-border);
        color: white;
        font-size: 1.5rem;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        justify-content: center;
      }

      #music-toggle:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: scale(1.1);
      }

      #music-toggle.playing {
        background: var(--primary-pink);
        box-shadow: 0 0 10px rgba(233, 30, 99, 0.5);
      }

      /* Buttons */
      .btn {
        padding: 12px 25px;
        background: var(--gradient-primary);
        border: none;
        border-radius: 50px;
        color: white;
        font-size: 1rem;
        cursor: pointer;
        transition: var(--transition);
        margin: 10px;
        text-decoration: none;
        display: inline-block;
        font-weight: 500;
        box-shadow: 0 4px 10px rgba(233, 30, 99, 0.3);
      }

      .btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 7px 15px rgba(233, 30, 99, 0.4);
      }

      .glow-btn {
        box-shadow: 0 0 15px rgba(233, 30, 99, 0.5);
      }

      /* Animation for new features */
      @keyframes featurePulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
        100% {
          transform: scale(1);
        }
      }

      .feature-highlight {
        animation: featurePulse 2s infinite;
      }

      /* New Features */
      .gallery-actions {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin: 20px 0;
        flex-wrap: wrap;
      }

      .action-btn {
        padding: 10px 20px;
        background: rgba(25, 25, 40, 0.8);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 25px;
        color: var(--light-text);
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 0.9rem;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .action-btn:hover {
        background: rgba(40, 40, 60, 0.9);
        transform: translateY(-2px);
      }

      .empty-state {
        text-align: center;
        padding: 50px 20px;
        color: var(--muted-text);
        font-size: 1.2rem;
      }

      .empty-state i {
        font-size: 3rem;
        margin-bottom: 15px;
        display: block;
        opacity: 0.5;
      }

      /* Responsive adjustments */
      @media (max-width: 768px) {
        .page-title {
          font-size: 2.5rem;
        }

        .gallery-controls {
          gap: 10px;
        }

        .gallery-filter {
          padding: 8px 16px;
          font-size: 0.85rem;
        }

        .gallery-grid {
          grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
          gap: 15px;
        }

        .modal-controls {
          top: 10px;
          left: 10px;
        }

        .modal-btn {
          width: 40px;
          height: 40px;
          font-size: 1.1rem;
        }

        .nav-btn {
          width: 45px;
          height: 45px;
          font-size: 1.5rem;
        }

        .modal-counter {
          top: 10px;
          right: 10px;
          font-size: 0.9rem;
          padding: 8px 15px;
        }

        .close {
          top: 10px;
          right: 15px;
          font-size: 2rem;
          width: 40px;
          height: 40px;
        }
      }

      @media (max-width: 480px) {
        .page-title {
          font-size: 2rem;
        }

        .gallery-grid {
          grid-template-columns: 1fr;
        }

        .gallery-stats {
          font-size: 1rem;
          min-width: auto;
          width: 100%;
        }
      }
    </style>
  </head>
  <body>
    <!-- Background animations -->
    <div id="hearts-container"></div>
    <div id="petals-container"></div>

    <!-- Music controls -->
    <div id="music-controls">
      <button id="music-toggle">♪</button>
      <audio id="background-music" loop>
        <!-- In a real implementation, you would link to an actual audio file -->
        <!-- <source src="assets/music/romantic.mp3" type="audio/mpeg" /> -->
      </audio>
    </div>

    <!-- Main content -->
    <div class="container">
      <div class="content fade-in">
        <h1 class="page-title">Our Memories Gallery</h1>

        <!-- Gallery Controls -->
        <div class="gallery-controls">
          <div class="gallery-filter active" data-filter="all">
            All Memories
          </div>
          <div class="gallery-filter" data-filter="favorites">Favorites ⭐</div>
          <div class="gallery-filter" data-filter="recent">Most Recent</div>
          <div class="gallery-filter" data-filter="oldest">Oldest First</div>
        </div>

        <div class="gallery-stats">
          <span id="photo-count">6</span> Precious Moments •
          <span id="favorite-count">0</span> Favorites
        </div>

        <!-- Gallery Actions -->
        <div class="gallery-actions">
          <div class="action-btn" id="select-all"><i>✓</i> Select All</div>
          <div class="action-btn" id="deselect-all"><i>✕</i> Deselect All</div>
          <div class="action-btn" id="start-slideshow">
            <i>▶</i> Start Slideshow
          </div>
        </div>

        <div class="gallery-grid" id="gallery-grid">
          <!-- Gallery items will be populated by JavaScript -->
        </div>

        <a href="surprise.html" class="btn glow-btn">A Little Surprise 🎁</a>
      </div>
    </div>

    <!-- Enhanced Modal -->
    <div id="image-modal" class="modal">
      <span class="close">&times;</span>
      <div class="modal-controls">
        <button class="modal-btn" id="modal-favorite" title="Toggle favorite">
          ☆
        </button>
        <button class="modal-btn" id="modal-download" title="Download image">
          ⤓
        </button>
        <button class="modal-btn" id="modal-share" title="Share image">
          ↪
        </button>
      </div>
      <div class="modal-nav">
        <button class="nav-btn" id="prev-btn">‹</button>
        <button class="nav-btn" id="next-btn">›</button>
      </div>
      <div class="modal-counter">
        <span id="current-index">1</span> / <span id="total-images">6</span>
      </div>
      <div class="modal-content">
        <img id="modal-img" src="" alt="Enlarged memory" />
      </div>
    </div>

    <script>
      // Enhanced Gallery Functionality
      document.addEventListener("DOMContentLoaded", function () {
        // DOM Elements
        const galleryGrid = document.getElementById("gallery-grid");
        const modal = document.getElementById("image-modal");
        const modalImg = document.getElementById("modal-img");
        const closeBtn = document.querySelector(".close");
        const filters = document.querySelectorAll(".gallery-filter");
        const modalFavorite = document.getElementById("modal-favorite");
        const modalDownload = document.getElementById("modal-download");
        const modalShare = document.getElementById("modal-share");
        const prevBtn = document.getElementById("prev-btn");
        const nextBtn = document.getElementById("next-btn");
        const currentIndexSpan = document.getElementById("current-index");
        const totalImagesSpan = document.getElementById("total-images");
        const photoCountSpan = document.getElementById("photo-count");
        const favoriteCountSpan = document.getElementById("favorite-count");
        const selectAllBtn = document.getElementById("select-all");
        const deselectAllBtn = document.getElementById("deselect-all");
        const startSlideshowBtn = document.getElementById("start-slideshow");
        const musicToggle = document.getElementById("music-toggle");
        const backgroundMusic = document.getElementById("background-music");
        const heartsContainer = document.getElementById("hearts-container");
        const petalsContainer = document.getElementById("petals-container");

        // Sample gallery data (in a real app, this would come from a database)
        const galleryData = [
          {
            id: 1,
            src: "assets/me1.jpeg",
            alt: "Our first date",
            date: "2023-01-15",
            favorite: false,
          },
          {
            id: 2,
            src: "assets/me2.jpeg",
            alt: "Beach vacation",
            date: "2023-03-22",
            favorite: false,
          },
          {
            id: 3,
            src: "assets/me3.jpeg",
            alt: "Anniversary dinner",
            date: "2023-05-10",
            favorite: false,
          },
          {
            id: 4,
            src: "assets/me4.jpeg",
            alt: "Mountain hike",
            date: "2023-07-05",
            favorite: false,
          },
          {
            id: 5,
            src: "assets/me5.jpeg",
            alt: "City lights",
            date: "2023-09-18",
            favorite: false,
          },
          {
            id: 6,
            src: "assets/me6.jpeg",
            alt: "Cozy evening",
            date: "2023-11-30",
            favorite: false,
          },
        ];

        let currentImageIndex = 0;
        let autoSlideInterval;
        let slideSpeed = 3000; // Default speed
        let isPlaying = false;

        // Initialize the gallery
        function initializeGallery() {
          renderGalleryItems();
          updateGalleryStats();
          initializeBackgroundEffects();
          initializeMusicControls();
          loadFavoritesFromStorage();
        }

        // Render gallery items
        function renderGalleryItems() {
          galleryGrid.innerHTML = "";

          galleryData.forEach((item, index) => {
            const galleryItem = document.createElement("div");
            galleryItem.className = "gallery-item";
            galleryItem.dataset.index = index;
            galleryItem.dataset.favorite = item.favorite;
            galleryItem.dataset.date = item.date;

            galleryItem.innerHTML = `
              <button class="gallery-favorite" title="Add to favorites">${
                item.favorite ? "★" : "☆"
              }</button>
              <button class="gallery-zoom" title="Zoom image">🔍</button>
              <button class="gallery-download" title="Download image">⤓</button>
              <img src="${item.src}" alt="${item.alt}" />
            `;

            galleryGrid.appendChild(galleryItem);
          });

          // Add event listeners to gallery items
          addGalleryEventListeners();
        }

        // Add event listeners to gallery items
        function addGalleryEventListeners() {
          const galleryItems = document.querySelectorAll(".gallery-item");
          const favoriteBtns = document.querySelectorAll(".gallery-favorite");
          const downloadBtns = document.querySelectorAll(".gallery-download");
          const zoomBtns = document.querySelectorAll(".gallery-zoom");

          galleryItems.forEach((item, index) => {
            item.addEventListener("click", (e) => {
              if (
                !e.target.classList.contains("gallery-favorite") &&
                !e.target.classList.contains("gallery-download") &&
                !e.target.classList.contains("gallery-zoom")
              ) {
                openModal(index);
              }
            });
          });

          favoriteBtns.forEach((btn, index) => {
            btn.addEventListener("click", (e) => {
              e.stopPropagation();
              toggleFavorite(index);
              btn.classList.add("feature-highlight");
              setTimeout(() => btn.classList.remove("feature-highlight"), 2000);
            });
          });

          downloadBtns.forEach((btn, index) => {
            btn.addEventListener("click", (e) => {
              e.stopPropagation();
              downloadImage(index);
            });
          });

          zoomBtns.forEach((btn, index) => {
            btn.addEventListener("click", (e) => {
              e.stopPropagation();
              openModal(index);
            });
          });
        }

        // Enhanced modal opening with controls
        function openModal(index) {
          currentImageIndex = index;
          modalImg.src = galleryData[index].src;
          modal.style.display = "flex";
          updateModalControls();
          startAutoSlide();
        }

        function updateModalControls() {
          currentIndexSpan.textContent = currentImageIndex + 1;
          totalImagesSpan.textContent = galleryData.length;

          // Update favorite button state
          const isFavorite = galleryData[currentImageIndex].favorite;
          modalFavorite.textContent = isFavorite ? "★" : "☆";
          modalFavorite.style.color = isFavorite ? "gold" : "white";
        }

        // Enhanced auto-slide functionality
        function startAutoSlide() {
          clearInterval(autoSlideInterval);
          autoSlideInterval = setInterval(() => {
            nextImage();
          }, slideSpeed);
        }

        function nextImage() {
          currentImageIndex = (currentImageIndex + 1) % galleryData.length;
          modalImg.src = galleryData[currentImageIndex].src;
          updateModalControls();
        }

        function prevImage() {
          currentImageIndex =
            (currentImageIndex - 1 + galleryData.length) % galleryData.length;
          modalImg.src = galleryData[currentImageIndex].src;
          updateModalControls();
        }

        // Favorite functionality
        function toggleFavorite(index) {
          galleryData[index].favorite = !galleryData[index].favorite;

          const galleryItem = document.querySelector(
            `.gallery-item[data-index="${index}"]`
          );
          const favoriteBtn = galleryItem.querySelector(".gallery-favorite");

          galleryItem.dataset.favorite = galleryData[index].favorite;
          favoriteBtn.textContent = galleryData[index].favorite ? "★" : "☆";
          favoriteBtn.classList.toggle("active", galleryData[index].favorite);

          updateFavoriteCount();
          updateModalControls();
          saveFavoritesToStorage();
        }

        function updateFavoriteCount() {
          const favoriteCount = galleryData.filter(
            (item) => item.favorite
          ).length;
          favoriteCountSpan.textContent = favoriteCount;
        }

        function updateGalleryStats() {
          photoCountSpan.textContent = galleryData.length;
          updateFavoriteCount();
        }

        // Download functionality
        function downloadImage(index) {
          const img = galleryData[index];
          const link = document.createElement("a");
          link.href = img.src;
          link.download = `memory-${index + 1}.jpg`;
          link.click();
        }

        // Share functionality
        function shareImage(index) {
          const img = galleryData[index];
          if (navigator.share) {
            navigator
              .share({
                title: "Our Memory",
                text: "Check out this beautiful memory from our relationship!",
                url: img.src,
              })
              .catch((error) => console.log("Error sharing:", error));
          } else {
            // Fallback for browsers that don't support the Web Share API
            alert("Share this image: " + img.src);
          }
        }

        // Filter functionality
        function filterGallery(filterType) {
          const galleryItems = document.querySelectorAll(".gallery-item");

          galleryItems.forEach((item) => {
            if (filterType === "all") {
              item.style.display = "block";
            } else if (filterType === "favorites") {
              item.style.display =
                item.dataset.favorite === "true" ? "block" : "none";
            } else if (filterType === "recent") {
              // Sort by date (newest first)
              const sortedItems = Array.from(galleryItems).sort(
                (a, b) => new Date(b.dataset.date) - new Date(a.dataset.date)
              );
              sortedItems.forEach((item, index) => {
                item.style.order = index;
                item.style.display = "block";
              });
            } else if (filterType === "oldest") {
              // Sort by date (oldest first)
              const sortedItems = Array.from(galleryItems).sort(
                (a, b) => new Date(a.dataset.date) - new Date(b.dataset.date)
              );
              sortedItems.forEach((item, index) => {
                item.style.order = index;
                item.style.display = "block";
              });
            }
          });
        }

        // Select All / Deselect All functionality
        function selectAllFavorites() {
          galleryData.forEach((item, index) => {
            if (!item.favorite) {
              toggleFavorite(index);
            }
          });
        }

        function deselectAllFavorites() {
          galleryData.forEach((item, index) => {
            if (item.favorite) {
              toggleFavorite(index);
            }
          });
        }

        // Initialize background effects
        function initializeBackgroundEffects() {
          // Create floating hearts
          for (let i = 0; i < 15; i++) {
            setTimeout(() => {
              createHeart();
            }, i * 500);
          }

          // Create falling petals
          for (let i = 0; i < 10; i++) {
            setTimeout(() => {
              createPetal();
            }, i * 700);
          }
        }

        function createHeart() {
          const heart = document.createElement("div");
          heart.classList.add("heart");
          heart.innerHTML = "💖";
          heart.style.left = Math.random() * 100 + "vw";
          heart.style.fontSize = Math.random() * 20 + 10 + "px";
          heart.style.animationDuration = Math.random() * 5 + 5 + "s";

          heartsContainer.appendChild(heart);

          // Remove heart after animation completes
          setTimeout(() => {
            heart.remove();
          }, 15000);

          // Create new heart periodically
          setTimeout(createHeart, Math.random() * 3000 + 2000);
        }

        function createPetal() {
          const petal = document.createElement("div");
          petal.classList.add("petal");
          petal.innerHTML = "🌸";
          petal.style.left = Math.random() * 100 + "vw";
          petal.style.fontSize = Math.random() * 15 + 10 + "px";
          petal.style.animationDuration = Math.random() * 7 + 7 + "s";

          petalsContainer.appendChild(petal);

          // Remove petal after animation completes
          setTimeout(() => {
            petal.remove();
          }, 20000);

          // Create new petal periodically
          setTimeout(createPetal, Math.random() * 4000 + 3000);
        }

        // Music controls
        function initializeMusicControls() {
          musicToggle.addEventListener("click", function () {
            if (isPlaying) {
              backgroundMusic.pause();
              musicToggle.classList.remove("playing");
              musicToggle.textContent = "♪";
            } else {
              backgroundMusic.play().catch((e) => {
                console.log("Audio play failed:", e);
                alert(
                  "Please interact with the page first to enable audio, or check if your browser allows autoplay."
                );
              });
              musicToggle.classList.add("playing");
              musicToggle.textContent = "♫";
            }
            isPlaying = !isPlaying;
          });
        }

        // Local Storage for favorites
        function saveFavoritesToStorage() {
          const favorites = galleryData.map((item) => item.favorite);
          localStorage.setItem("gallery-favorites", JSON.stringify(favorites));
        }

        function loadFavoritesFromStorage() {
          const savedFavorites = localStorage.getItem("gallery-favorites");
          if (savedFavorites) {
            const favorites = JSON.parse(savedFavorites);
            favorites.forEach((isFavorite, index) => {
              if (index < galleryData.length) {
                galleryData[index].favorite = isFavorite;

                const galleryItem = document.querySelector(
                  `.gallery-item[data-index="${index}"]`
                );
                if (galleryItem) {
                  galleryItem.dataset.favorite = isFavorite;
                  const favoriteBtn =
                    galleryItem.querySelector(".gallery-favorite");
                  favoriteBtn.textContent = isFavorite ? "★" : "☆";
                  favoriteBtn.classList.toggle("active", isFavorite);
                }
              }
            });
            updateFavoriteCount();
          }
        }

        // Event listeners
        filters.forEach((filter) => {
          filter.addEventListener("click", () => {
            filters.forEach((f) => f.classList.remove("active"));
            filter.classList.add("active");
            filterGallery(filter.dataset.filter);
          });
        });

        modalFavorite.addEventListener("click", () => {
          toggleFavorite(currentImageIndex);
        });

        modalDownload.addEventListener("click", () => {
          downloadImage(currentImageIndex);
        });

        modalShare.addEventListener("click", () => {
          shareImage(currentImageIndex);
        });

        prevBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          prevImage();
          startAutoSlide(); // Restart timer after manual navigation
        });

        nextBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          nextImage();
          startAutoSlide(); // Restart timer after manual navigation
        });

        closeBtn.addEventListener("click", closeModal);

        modal.addEventListener("click", (e) => {
          if (e.target === modal) {
            closeModal();
          }
        });

        selectAllBtn.addEventListener("click", selectAllFavorites);
        deselectAllBtn.addEventListener("click", deselectAllFavorites);

        startSlideshowBtn.addEventListener("click", () => {
          if (galleryData.length > 0) {
            openModal(0);
          }
        });

        function closeModal() {
          modal.style.display = "none";
          clearInterval(autoSlideInterval);
        }

        // Keyboard navigation
        document.addEventListener("keydown", (e) => {
          if (modal.style.display === "flex") {
            if (e.key === "Escape") closeModal();
            if (e.key === "ArrowRight") {
              nextImage();
              startAutoSlide();
            }
            if (e.key === "ArrowLeft") {
              prevImage();
              startAutoSlide();
            }
            if (e.key === "f") {
              toggleFavorite(currentImageIndex);
            }
            if (e.key === "d") {
              downloadImage(currentImageIndex);
            }
          }
        });

        // Initialize the gallery
        initializeGallery();
      });
    </script>
  </body>
</html>
